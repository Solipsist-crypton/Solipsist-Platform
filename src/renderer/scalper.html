<!-- src/renderer/scalper.html - ПОВНА ВЕРСІЯ З ГРАФІКОМ -->
<!DOCTYPE html>
<html lang="uk">
<head>
    <script src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.0.1/dist/lightweight-charts.standalone.production.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Скальпер SOL/USDT | Solipsist Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: #f8fafc;
            padding: 15px;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* ШАПКА */
        .header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            padding: 20px 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #334155;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .title {
            color: #60a5fa;
            font-size: 1.6em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .title i {
            color: #f59e0b;
        }
        
        .badge {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
            margin-left: 10px;
        }
        
        /* КНОПКИ КЕРУВАННЯ */
        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
            font-size: 0.95em;
            min-width: 110px;
            justify-content: center;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-start {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .btn-start:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .btn-stop:hover {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            color: white;
        }
        
        .btn-reset:hover {
            background: linear-gradient(135deg, #475569 0%, #334155 100%);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 100px;
            justify-content: center;
        }
        
        .status-online {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            border: 2px solid rgba(16, 185, 129, 0.3);
        }
        
        .status-offline {
            background: rgba(239, 68, 68, 0.15);
            color: #ef4444;
            border: 2px solid rgba(239, 68, 68, 0.3);
        }
        
        /* СТАТИСТИКА */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: #1e293b;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #334155;
            transition: all 0.2s ease;
        }
        
        .stat-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }
        
        .stat-label {
            color: #94a3b8;
            font-size: 0.9em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: white;
        }
        
        /* ГРАФІК */
        .chart-container {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #334155;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .chart-title {
            color: #60a5fa;
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-controls {
            display: flex;
            gap: 10px;
        }
        
        .chart-btn {
            background: #334155;
            color: #94a3b8;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.2s ease;
        }
        
        .chart-btn:hover {
            background: #3b82f6;
            color: white;
        }
        
        #priceChart {
            height: 500px;
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
        }
        
        /* ОСНОВНИЙ КОНТЕНТ */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: #1e293b;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #334155;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: 100%;
        }
        
        .panel-title {
            color: #60a5fa;
            margin-bottom: 20px;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-bottom: 10px;
            border-bottom: 2px solid #334155;
        }
        
        /* ПОЗИЦІЯ */
        .position-info {
            text-align: center;
            padding: 20px;
        }
        
        .position-type {
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
        }
        
        .position-long {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border: 2px solid #10b981;
        }
        
        .position-short {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 2px solid #ef4444;
        }
        
        .position-none {
            background: rgba(148, 163, 184, 0.1);
            color: #94a3b8;
            border: 2px solid #64748b;
        }
        
        .position-details {
            margin-top: 20px;
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
        }
        
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #334155;
        }
        
        .detail-row:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            color: #94a3b8;
        }
        
        .detail-value {
            color: white;
            font-weight: 500;
        }
        
        /* СИГНАЛИ */
        .signals-container {
            height: 350px;
            display: flex;
            flex-direction: column;
        }
        
        .signals-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .signals-list {
            flex: 1;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .signal-item {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid;
            background: rgba(30, 41, 59, 0.5);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.2s ease;
        }
        
        .signal-item:hover {
            background: rgba(30, 41, 59, 0.8);
            transform: translateX(5px);
        }
        
        .signal-buy {
            border-left-color: #10b981;
        }
        
        .signal-sell {
            border-left-color: #ef4444;
        }
        
        .signal-icon {
            font-size: 1.5em;
        }
        
        .signal-details {
            flex: 1;
        }
        
        .signal-time {
            color: #94a3b8;
            font-size: 0.85em;
        }
        
        .signal-type {
            font-weight: 600;
            margin: 5px 0;
        }
        
        .signal-price {
            color: white;
            font-weight: 500;
        }
        
        .signal-ema {
            color: #cbd5e1;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        /* ТАБЛИЦЯ СИГНАЛІВ */
        .signals-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .signals-table th {
            background: #334155;
            color: #e2e8f0;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            border-bottom: 2px solid #475569;
        }
        
        .signals-table td {
            padding: 12px;
            border-bottom: 1px solid #374151;
            color: #cbd5e1;
        }
        
        .signals-table tr:hover {
            background: #2d3748;
        }
        
        /* ЛОГ */
        .log-container {
            height: 300px;
            display: flex;
            flex-direction: column;
        }
        
        .log {
            flex: 1;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 8px;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border: 1px solid #334155;
        }
        
        .log-entry {
            padding: 8px 0;
            border-bottom: 1px solid rgba(51, 65, 85, 0.5);
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-time {
            color: #64748b;
            min-width: 70px;
        }
        
        .log-message {
            flex: 1;
        }
        
        .log-info {
            color: #94a3b8;
        }
        
        .log-success {
            color: #10b981;
        }
        
        .log-error {
            color: #ef4444;
        }
        
        .log-warning {
            color: #f59e0b;
        }
        
        /* ІНФОРМАЦІЯ ПРО СТРАТЕГІЮ */
        .strategy-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        
        .strategy-title {
            color: #60a5fa;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .strategy-desc {
            color: #cbd5e1;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        /* СКРОЛБАР */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1e293b;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* АДАПТИВНІСТЬ */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .controls {
                width: 100%;
                justify-content: center;
            }
            
            .btn {
                min-width: 90px;
                padding: 10px 16px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            #priceChart {
                height: 350px;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                min-width: auto;
                padding: 10px 12px;
                font-size: 0.85em;
            }
            
            .status {
                min-width: auto;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ШАПКА -->
        <div class="header">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div class="title">
                    <i class="fas fa-bolt"></i>
                    <span>Скальпер SOL/USDT</span>
                </div>
                <div class="badge">EMA 5/13 • 1М • Бумажна торгівля</div>
            </div>
            
            <div class="controls">
                <button id="btnStart" class="btn btn-start">
                    <i class="fas fa-play"></i> Старт
                </button>
                <button id="btnStop" class="btn btn-stop" disabled>
                    <i class="fas fa-stop"></i> Стоп
                </button>
                <button id="btnReset" class="btn btn-reset">
                    <i class="fas fa-redo"></i> Скинути
                </button>
                <div id="statusIndicator" class="status status-offline">
                    <i class="fas fa-circle"></i> Офлайн
                </div>
            </div>
        </div>
        
        <!-- СТАТИСТИКА -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-wallet"></i> Баланс</div>
                <div id="statEquity" class="stat-value">$1,000.00</div>
            </div>
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-signal"></i> Сигналів</div>
                <div id="statSignals" class="stat-value">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-trophy"></i> Win Rate</div>
                <div id="statWinRate" class="stat-value">0%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label"><i class="fas fa-arrow-trend-up"></i> Позиція</div>
                <div id="statPosition" class="stat-value">Немає</div>
            </div>
        </div>
        
        <!-- ГРАФІК -->
        <div class="chart-container">
            <div class="chart-header">
                <div class="chart-title">
                    <i class="fas fa-chart-line"></i> Графік SOL/USDT (1 хвилина)
                </div>
                <div class="chart-controls">
                    <button id="btnZoomIn" class="chart-btn" title="Збільшити">
                        <i class="fas fa-search-plus"></i>
                    </button>
                    <button id="btnZoomOut" class="chart-btn" title="Зменшити">
                        <i class="fas fa-search-minus"></i>
                    </button>
                    <button id="btnFitContent" class="chart-btn" title="Показати все">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>
            <div id="priceChart"></div>
            
            <!-- Інформація про стратегію -->
            <div class="strategy-info">
                <div class="strategy-title">Стратегія EMA Crossover</div>
                <div class="strategy-desc">
                    <strong>BUY</strong>: коли EMA 5 перетинає EMA 13 знизу вверх • 
                    <strong>SELL</strong>: коли EMA 5 перетинає EMA 13 зверху вниз • 
                    Обов'язкове чергування: після BUY тільки SELL, після SELL тільки BUY
                </div>
            </div>
        </div>
        
        <!-- ОСНОВНИЙ КОНТЕНТ -->
        <div class="content-grid">
            <!-- ЛІВА КОЛОНКА -->
            <div>
                <!-- ПОЗИЦІЯ -->
                <div class="panel">
                    <div class="panel-title">
                        <i class="fas fa-chess-board"></i> Поточна позиція
                    </div>
                    <div class="position-info">
                        <div id="positionType" class="position-type position-none">
                            НЕАКТИВНО
                        </div>
                        <div id="positionDetails" class="position-details">
                            <div class="detail-row">
                                <span class="detail-label">Ціна входу:</span>
                                <span id="entryPrice" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Поточна ціна:</span>
                                <span id="currentPrice" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">PnL:</span>
                                <span id="positionPnl" class="detail-value">-</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Час відкриття:</span>
                                <span id="openTime" class="detail-value">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ЛОГ -->
                <div class="panel">
                    <div class="panel-title">
                        <i class="fas fa-terminal"></i> Лог подій
                        <button id="btnClearLog" class="chart-btn" style="margin-left: auto; padding: 5px 10px; font-size: 0.8em;">
                            <i class="fas fa-trash"></i> Очистити
                        </button>
                    </div>
                    <div class="log-container">
                        <div id="eventLog" class="log">
                            <!-- Лог подій буде тут -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ПРАВА КОЛОНКА -->
            <div>
                <!-- ОСТАННІ СИГНАЛИ -->
                <div class="panel">
                    <div class="panel-title">
                        <i class="fas fa-bell"></i> Останні сигнали
                        <button id="btnRefreshSignals" class="chart-btn" style="margin-left: auto; padding: 5px 10px; font-size: 0.8em;">
                            <i class="fas fa-sync"></i>
                        </button>
                    </div>
                    <div class="signals-container">
                        <div id="signalsList" class="signals-list">
                            <!-- Сигнали будуть тут -->
                        </div>
                        <!-- Таблиця сигналів -->
                        <div style="margin-top: 15px;">
                            <table class="signals-table">
                                <thead>
                                    <tr>
                                        <th>Час</th>
                                        <th>Тип</th>
                                        <th>Ціна</th>
                                        <th>EMA 5</th>
                                        <th>EMA 13</th>
                                    </tr>
                                </thead>
                                <tbody id="signalsBody">
                                    <!-- Дані таблиці будуть тут -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ФУТЕР -->
        <div style="text-align: center; color: #64748b; font-size: 0.85em; padding: 20px; margin-top: 20px; border-top: 1px solid #334155;">
            <div style="margin-bottom: 10px;">
                <i class="fas fa-exclamation-triangle" style="color: #f59e0b; margin-right: 8px;"></i>
                <strong>ТЕСТОВИЙ РЕЖИМ:</strong> Всі операції виконуються з віртуальним балансом
            </div>
            <div>Solipsist Platform • Скальпер-модуль • © 2024</div>
        </div>
    </div>
    
    <script src="scalper.js"></script>
    <script>
        // Додаткові кнопки керування графіком
        document.addEventListener('DOMContentLoaded', function() {
            const btnZoomIn = document.getElementById('btnZoomIn');
            const btnZoomOut = document.getElementById('btnZoomOut');
            const btnFitContent = document.getElementById('btnFitContent');
            const btnClearLog = document.getElementById('btnClearLog');
            const btnRefreshSignals = document.getElementById('btnRefreshSignals');
            
            if (btnZoomIn) {
                btnZoomIn.addEventListener('click', function() {
                    if (window.scalperUI && window.scalperUI.chart) {
                        const timeScale = window.scalperUI.chart.timeScale();
                        const range = timeScale.getVisibleRange();
                        if (range) {
                            const diff = range.to - range.from;
                            timeScale.setVisibleRange({
                                from: range.from + diff * 0.1,
                                to: range.to - diff * 0.1
                            });
                        }
                    }
                });
            }
            
            if (btnZoomOut) {
                btnZoomOut.addEventListener('click', function() {
                    if (window.scalperUI && window.scalperUI.chart) {
                        const timeScale = window.scalperUI.chart.timeScale();
                        const range = timeScale.getVisibleRange();
                        if (range) {
                            const diff = range.to - range.from;
                            timeScale.setVisibleRange({
                                from: range.from - diff * 0.1,
                                to: range.to + diff * 0.1
                            });
                        }
                    }
                });
            }
            
            if (btnFitContent) {
                btnFitContent.addEventListener('click', function() {
                    if (window.scalperUI && window.scalperUI.chart) {
                        window.scalperUI.chart.timeScale().fitContent();
                    }
                });
            }
            
            if (btnClearLog) {
                btnClearLog.addEventListener('click', function() {
                    const logElement = document.getElementById('eventLog');
                    if (logElement) {
                        logElement.innerHTML = '';
                    }
                });
            }
            
            if (btnRefreshSignals) {
                btnRefreshSignals.addEventListener('click', function() {
                    if (window.scalperUI && window.scalperUI.updateSignalsTable) {
                        window.scalperUI.updateSignalsTable();
                    }
                });
            }
            
            // Автоматичне оновлення розміру графіка
            window.addEventListener('resize', function() {
                if (window.scalperUI && window.scalperUI.chart) {
                    const container = document.getElementById('priceChart');
                    if (container) {
                        window.scalperUI.chart.applyOptions({
                            width: container.clientWidth
                        });
                    }
                }
            });
        });
    </script>
</body>
</html>